## 5장. 책임과 메시지



- 두명의 심리학자의 실험은 사건의 목격자가 많을 수록 사람들의 책임감은 낮아진다는 '책임감 분산 현상'을 보여줌
  - 명확한 책임과 역할을 지닌 참가자들이 협력에 참여해야한다!



#### 자율적인 책임

<u>책임-주도 설계는 적절한 책임의 선택이 전체 설계의 방향을 결정</u>

**<u>책임</u>** : 요청을 처리하기 위해 객체가 수행하는 행동

> 책임은 자율성을 보장할 정도로 충분히 추상적이고 동시에 의도를 표현할 수 있을 정도로 충분히 구체적이어야 한다.
>
> 자율적인 책임의 특징은 How(어떻게) 해야 하는가 X, What(무엇을) 해야 하는가 O



#### 메시지와 메서드

**<u>메시지</u>** : 자신의 책임을 수행하게 만드는 유일한 방법

>메시지는 메시지 이름(name)과 추가 정보를 제공할 수 있게 해주는 메시지의 인자(argument)로 구성되어있다

- 메시지 전송은 수신자, 메시지 이름, 인자의 조합

  ```
  모자장수.증언하라(어제, 왕국)
  ```

- 메시지를 처리할 수 있다 : 객체가 해당 메시지에 해당하는 행동을 수행해야 할 책임이 있다
- 객체가 수신할 수 있는 메시지의 모양이 객체가 수행할 책임의 모양을 결정
- 객체의 외부와 내부가 메시지를 기준으로 분리되어야 함

**<u>메서드</u>** : 메시지를 처리하기 위해 내부적으로 선택하는 방법

>메시지는 '무엇'이 실행되기를 바라는지만 명시, 어떤 메서드를 선택할 것인지는 수신자의 결정에 좌우된다

- 메시지를 수신한 객체가 실행 시간에 메서드를 선택할 수 있다 > 객체지향 프로그래밍 언어의 핵심적인 특징

<u>**다형성**</u> : 서로 다른 유형의 객체가 동일한 메시지에 대해 서로 다르게 반응하는 것

>동일한 메시지여도 서로 다른 방식의 메서드를 이용해 처리할 수 있다
>
>'증언하라' 메시지에 대해 3명이 다른 방법을 사용하던 간에 모두 '증언' 하고 있는 것
>
>다형성은 대체가능성을 의미
>
>다형성은 송신자와 수신자간의 객체 타입에 대한 결합도를 메시지에 대한 결합도로 낮춤으로써 달성

1. 협력이 유연해진다 
   - 송신자는 수신자가 메시지를 이해한다면 누구라도 상관X
2. 협력이 수행되는 방식을 확상할 수 있다
   - 협력이 동작하는 방식은 변경되지만 협력의 구조자체는 변하지 않는다
3. 협력이 수행되는 방식을 재사용할 수 있다
   - 대체가능성때문

- 진정항 객체지향은 객체들 사이의 커뮤니케이션에 초점을 맞춰야 한다
  - 클래스는 단지 추상화 도구일 뿐 클래스에 집중하지 않기
  - 협력이라는 문맥안에서 메시지 위주로 객체를 설계한다
  - 데이터 중심으로 객체를 설계하면 객체의 내부구조를 정의의 일부로 만들기 때문에 객체의 자율성을 저해 > 데이터-주도 설계
- 책임-주도 설계
  - 시스템이 수행할 책임들을 찾는다
  - 적절한 객체에 책임을 할당한다
  - 책임을 수행할 때 다른 객체의 도움이 필요하면 어떤 메시지가 필요한지 결정한다
  - 수신하기에 적합한 객체를 선택한다 > 메시지가 수신자의 책임을 결정
- What/Who 사이클
  - 무엇을 해야하는지 결정(메시지를 결정)하고 그것을 누가 수행하는지 결정(메시지를 수신할 적합한 객체를 결정)
- Tell, Don't Ask
  - 수신자가 '어떻게' 책임을 수행하는지 지시하지 않고 '무엇'을 해야하는지 요청하는 것
  - 결과적으로 수신자의 캡슐화를 증진



#### 객체 인터페이스

**<u>인터페이스</u>** : 두 사물의 사이에서 서로 상호작용할 수 있게 이어주는 방법 또는 장치

>1. 내부 구조나 동작 방식을 몰라도 대상을 조작하거나 의사를 전달할 수 있다
>2. 인터페이스 자체를 변경하지 않는다면 내부 구성이나 작동 방식을 변경해도 사용자에게 어떤 영향도 미치지 않는다
>3. 동일한 인터페이스를 제공한다면 대상이 변경되더라도 문제가 없다

- 객체의 인터페이스는 객체가 수신할 수 있는 메시지로 구성된다
  - 결국 메시지가 인터페이스를 결정
- 객체는 다른 객체와 상호작용하는것 뿐만아니라 자기 자신과도 상호작용해야한다
  - 두 상호작용을 구분하기 위해 다른 객체에게 공개된 인터페이스를 '**공용 인터페이스**' 라한다.

- 인터페이스의 원칙

  1. 좀 더 추상적인 인터페이스

     >'어떻게' 증언을 하라고 구체적으로 요청하는 것과 '증언하라' 라고 '무엇'을 하라고 요청하는 것의 차이

  2. 최소 인터페이스

     > 다른 객체가 사용할 필요가 없는 인터페이스는 최대한 노출하지 않는 것

  3. **인터페이스**와 **구현**간의 차이가 있음을 인식

     > 객체의 외부와 내부를 분리!

**<u>구현</u>** : 공용 인터페이스에 포함되지 않는 객체를 구성 하는 모든 것, 내부 구조와 작동 방식, 객체의 내부

> 객체의 메서드를 구성하는 코드는 구현에 포함

- 인터페이스와 구현의 분리 원칙 : 공용 인터페이스와 구현을 명확하게 분리해서 고려해야 하는 것
  - 객체를 두개의 요소로 분리해 설계하는 것
  - 객체의 자율성을 향상 시키는 방법
  - 이를 수행할 객체 설계 방법을 **캡슐화**라고 한다 

**<u>캡슐화</u>** : 객체의 자율성을 보존하기 위해 구현을 외부로 부터 감추는 것, 정보 은닉

- 상태와 행위의 캡슐화 : 데이터 캡슐화 

  > 인터페이스와 구현을 분리하기 위한 전제 조건 > 자율적인 객체

- 사적인 비밀의 캡슐화 : 외부의 객체가 자신의 내부 상태를 직접 관찰하거나 제어할 수 없도록 하는것, 보안



- 전체 협력의 설계 품질은 책임들이 얼마나 자율적인지가 결정한다

  1. 자율적인 책임은 협력을 단순하게 한다

     > 책임이 적절하게 추상화 되는것

  2. 자율적인 책임은 객체의 외부와 내부를 명확하게 분리한다

     > 외부 객체는 메시지 수신자가 책임을 완수할 수 있다면 수신자가 '어떻게' 책임을 완수하는지 상관하지 않는다
     >
     > - 사적인 부분이 객체 내부로 캡슐화된다

  3. 책임이 자율적일 경우 내부 방법을 변경해도 외부에 영향을 미치지 않는다

     > 객체의 외부와 내부를 명확하게 분리하기 때문에 외부 객체가 요청한 책임을 완수하기만 한다면 내부 방법을 변경해도 외부에 영향을 미치지 않는다
     >
     > - 두 객체의 결합도가 낮아진다

  4. 자율적인 책임은 협력의 대상을 다양하게 선택할 수 있는 유연성을 제공한다

     > 책임을 완수하기만 하면 누가 책임을 수행하는지는 협력에 문제가 되지않는다
     >
     > - 재사용성이 높아진다

  5. 책임이 자유로울수록 객체의 역할을 이해하기 쉬워진다

     >'증인석에 입장하다' 와 '증언하다' 라는 책임은 '증인' 이라는 객체를 설명하기에 충분하다

- 객체들의 책임이 자율적일수록 객체의 응집도는 높아진다

